<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valentine Surprise ‚ù§Ô∏è</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Pacifico&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root { --p: #ff6b95; --s: 'Dancing Script', cursive; --f: 'Pacifico', cursive; }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Poppins', sans-serif; background: linear-gradient(180deg, #fce4ec 0%, #e1bee7 100%);
            height: 100vh; display: flex; justify-content: center; align-items: center;
            flex-direction: column; overflow: hidden; text-align: center; color: #444;
        }
        .brand-logo { font-family: var(--f); font-size: 16px; color: rgba(216, 27, 96, 0.7); margin-bottom: 10px; }
        .card {
            background: rgba(255, 255, 255, 0.45); backdrop-filter: blur(15px);
            border-radius: 35px; padding: 25px; width: 92%; max-width: 400px;
            box-shadow: 0 15px 35px rgba(255, 107, 149, 0.2); border: 1px solid rgba(255, 255, 255, 0.5);
            position: relative; z-index: 10;
        }
        .photo-gallery { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 15px; max-height: 200px; overflow-y: auto; }
        .photo-gallery img { 
            width: 100%; border-radius: 12px; opacity: 0; transform: scale(0.3); 
            transition: all 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275); border: 3px solid white; 
        }
        .photo-gallery img.show { opacity: 1; transform: scale(1); }
        .typing-text { font-family: var(--s); font-size: 24px; color: #6a1b9a; }
        .letter-box { background: #fff9fa; border: 2px solid #ffcad4; border-radius: 20px; padding: 15px; margin: 10px 0; }
        .name-h { font-family: var(--f); color: #d81b60; font-size: 26px; }
        .btn { border-radius: 30px; border: none; cursor: pointer; font-family: var(--s); font-size: 20px; width: 100%; margin-top: 10px; padding: 10px; }
        .btn-p { background: linear-gradient(45deg, #ff3385, #ff6b95); color: white; }
        #muteBtn { position: fixed; top: 20px; right: 20px; width: 40px; height: 40px; border-radius: 50%; background: white; border: none; z-index: 1000; }
        input, textarea { width: 100%; padding: 10px; margin: 8px 0; border-radius: 12px; border: 1px solid #ffdae3; font-family: var(--s); font-size: 18px; }
        .hidden { display: none !important; }
        .final-quote { font-family: var(--s); font-size: 18px; color: #d81b60; opacity: 0; transition: 2s; margin-top: 10px; }
        .final-quote.show { opacity: 1; }
    </style>
</head>
<body>

    <div class="brand-logo">Designed by @soumajit !! ‚ú®</div>
    <button id="muteBtn" onclick="toggleMute()">üéµ</button>
    <audio id="bgMusic" loop> <source src="music.mp3" type="audio/mpeg"> </audio>

    <div id="step-1" class="card">
        <h2 style="font-family: var(--f); color: var(--p);">Create Surprise ‚ù§Ô∏è</h2>
        <input type="text" id="pName" placeholder="Partner Name">
        <textarea id="pMsg" placeholder="Special Message"></textarea>
        <p style="font-size: 12px; margin-bottom: 5px;">Upload 1 Photo (Main)</p>
        <input type="file" id="fileIn" accept="image/*">
        <button class="btn btn-p" onclick="generateLink()">Generate & View ‚ú®</button>
    </div>

    <div id="step-loading" class="card hidden">
        <h2 style="font-family: var(--f); color: var(--p);">Cuteness Loading...</h2>
        <h1 id="perc" style="font-size: 40px; color: var(--p);">0%</h1>
        <button id="tapBtn" class="btn hidden" style="background:white; color:#ff3385;" onclick="startTyping()">Tap to Open üíå</button>
    </div>

    <div id="step-typing" class="card hidden">
        <div id="animatedText" class="typing-text"></div>
        <button id="nextBtn" class="btn btn-p hidden" onclick="showPropose()">Next ‚ú®</button>
    </div>

    <div id="step-propose" class="card hidden">
        <img src="panda.gif" style="width: 100px; border-radius: 10px;">
        <div class="letter-box">
            <span id="displayPartnerName" class="name-h"></span><br>
            <span style="font-family: var(--s); font-size: 20px;">Will you be my Valentine? ü•∫</span>
        </div>
        <button class="btn btn-p" onclick="showFinal()">YES ü•∞</button>
        <button id="noBtn" class="btn" style="background:#eee;" onmouseover="moveNo()">NO ü•∫</button>
    </div>

    <div id="step-final" class="card hidden">
        <h2 class="name-h">Sweet Memories ‚ú®</h2>
        <div id="photoGallery" class="photo-gallery"></div>
        <p id="finalQuoteText" class="final-quote">"I fell in love with you because of the million things you never knew you were doing."</p>
        <button class="btn btn-p" style="margin-top:15px; font-size: 14px;" onclick="copyLink()">üîó Copy Link to Share</button>
        <button class="btn" style="font-size: 12px;" onclick="window.location.search=''; location.reload();">Create New üéÅ</button>
    </div>

    <script>
        let partnerName = "", message = "", photoData = "";
        const audio = document.getElementById('bgMusic');

        // ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï‡ßá ‡¶°‡¶æ‡¶ü‡¶æ ‡¶Ü‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡¶æ
        window.onload = () => {
            const params = new URLSearchParams(window.location.search);
            if (params.has('n')) {
                partnerName = params.get('n');
                message = params.get('m');
                // ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶¨‡ßá ‡¶Ø‡¶¶‡¶ø ‡¶°‡¶æ‡¶ü‡¶æ ‡¶•‡¶æ‡¶ï‡ßá
                document.getElementById('step-1').classList.add('hidden');
                document.getElementById('step-loading').classList.remove('hidden');
                startLoadingBar();
            }
        };

        function generateLink() {
            const n = document.getElementById('pName').value;
            const m = document.getElementById('pMsg').value;
            if (!n || !m) return alert("Fill all fields!");
            
            // URL ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ (‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡ßá‡¶≠ ‡¶∞‡¶æ‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø)
            const newUrl = `${window.location.origin}${window.location.pathname}?n=${encodeURIComponent(n)}&m=${encodeURIComponent(m)}`;
            window.history.pushState({}, '', newUrl);
            location.reload(); // ‡¶∞‡¶ø‡¶≤‡ßã‡¶° ‡¶¶‡¶ø‡¶≤‡ßá ‡¶â‡¶™‡¶∞‡ßá‡¶∞ window.onload ‡¶∞‡¶æ‡¶® ‡¶ï‡¶∞‡¶¨‡ßá
        }

        function startLoadingBar() {
            audio.play();
            let w = 0;
            const int = setInterval(() => {
                w++;
                document.getElementById('perc').innerText = w + "%";
                if (w >= 120) {
                    clearInterval(int);
                    document.getElementById('tapBtn').classList.remove('hidden');
                }
            }, 30);
        }

        function startTyping() {
            document.getElementById('step-loading').classList.add('hidden');
            document.getElementById('step-typing').classList.remove('hidden');
            let i = 0;
            function type() {
                if (i < message.length) {
                    document.getElementById('animatedText').innerHTML += message.charAt(i);
                    i++; setTimeout(type, 70);
                } else {
                    document.getElementById('nextBtn').classList.remove('hidden');
                }
            }
            type();
        }

        function showPropose() {
            document.getElementById('step-typing').classList.add('hidden');
            document.getElementById('step-propose').classList.remove('hidden');
            document.getElementById('displayPartnerName').innerText = partnerName;
        }

        function showFinal() {
            document.getElementById('step-propose').classList.add('hidden');
            document.getElementById('step-final').classList.remove('hidden');
            // ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ‡¶ö‡¶æ‡¶á‡¶≤‡ßá ‡¶Ü‡¶∞‡¶ì ‡¶õ‡¶¨‡¶ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ï‡ßã‡¶° ‡¶¶‡¶ø‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®
            setTimeout(() => { document.getElementById('finalQuoteText').classList.add('show'); }, 1000);
        }

        function copyLink() {
            navigator.clipboard.writeText(window.location.href);
            alert("Link Copied! Share it with your partner. ‚ù§Ô∏è");
        }

        function toggleMute() { audio.muted = !audio.muted; }
        function moveNo() {
            const b = document.getElementById('noBtn');
            b.style.position = 'absolute';
            b.style.left = Math.random() * 80 + '%';
            b.style.top = Math.random() * 80 + '%';
        }
    </script>
</body>
</html>
